---
import { getCollection } from 'astro:content';
import { Image } from 'astro:assets';
import { Icon } from 'astro-icon/components';
import { sortByOrder } from '@/utils/content-collections';
import heroImage from '@/assets/turkceduzelt.png';
import BlurryGradient from '@/assets/blurry-gradient.svg';
import MainLayout from '@/layouts/main-layout.astro';
import LinkButton from '@/components/link-button.astro';
import ProjectCard from '@/components/project-card.astro';
import FormField from '@/components/form-field.astro';
import FormLabel from '@/components/form-label.astro';
import FormInput from '@/components/form-input.astro';
import FormTextarea from '@/components/form-textarea.astro';
import Button from '@/components/button.astro';
import Frame from '@/components/frame.astro';
import ContactForm from '@/components/contact-form.astro';
import Technology from '@/components/technology.astro';

const featuredProjects = await getCollection(
  'projects',
  ({ data }) => data.featured,
).then(sortByOrder);

const technologies = await getCollection('technologies');

const contact = await getCollection('contact');
---

<MainLayout
  title="Özgür Gökdemir — Frontend Developer"
  description="Özgür Gökdemir is a frontend developer specializing in building responsive and high-performance web applications using TypeScript, React, and Next.js."
>
  <section
    id="home"
    class="scroll-mt-header mx-auto flex max-w-7xl flex-col gap-16 px-4 py-16 md:gap-48 md:px-6 md:pt-48 md:pb-24 lg:px-8"
    data-animate
  >
    <div class="flex flex-col gap-6 md:items-center">
      <h1
        class="text-5xl font-semibold tracking-tight md:text-center md:text-6xl lg:text-7xl"
        data-stagger-index="0"
      >
        Hi, I'm Özgür Gökdemir.
        <br />
        I'm a frontend developer.
      </h1>
      <p
        class="text-muted-foreground text-xl md:text-2xl"
        data-stagger-index="1"
      >
        I build high-performance and responsive web applications.
      </p>
      <div class="mt-2 flex items-center gap-4" data-stagger-index="2">
        <LinkButton id="contact-link" href="/#contact">
          <Icon name="heroicons:chat-bubble-left-ellipsis-16-solid" />
          Let's Talk
        </LinkButton>
        <LinkButton href="/projects" variant="outline">
          View my work
        </LinkButton>
      </div>
    </div>
    <Frame data-stagger-index="3">
      <div
        class="relative aspect-video overflow-hidden rounded-2xl bg-cover bg-center"
      >
        <BlurryGradient class="absolute h-full w-full" />
        <Image
          src={heroImage}
          alt="featured project"
          width={1280}
          height={720}
          layout="constrained"
          priority={true}
          class="pointer-events-none absolute top-1/10 left-1/8 scale-110 skew-x-4 -skew-y-12 rounded-xl ring-[clamp(0.25rem,1vw,0.5rem)] ring-black/10 select-none md:rounded-2xl"
        />
      </div>
    </Frame>
  </section>
  <section
    id="about"
    class="scroll-mt-header mx-auto grid max-w-7xl gap-16 px-4 py-16 md:grid-cols-2 md:items-center md:gap-4 md:px-6 md:py-24 lg:px-8"
    data-animate
  >
    <div class="flex flex-col items-start gap-4 lg:pr-12">
      <h2 class="text-3xl font-semibold" data-stagger-index="0">
        Get to know me.
      </h2>
      <p class="text-muted-foreground text-lg" data-stagger-index="1">
        I'm a frontend developer based in Türkiye, specializing in building
        dynamic web applications using TypeScript, React, and Next.js. I develop
        interactive features and optimize user experiences to deliver fast,
        efficient, and user-friendly solutions. Whether working independently or
        as part of a team, I aim to meet both business and user needs.
      </p>
      <LinkButton
        href={contact.find(({ data }) => data.id === 'linkedin')?.data.url}
        target="_blank"
        class="group mt-2"
        data-stagger-index="2"
      >
        More about me
        <Icon
          name="heroicons:arrow-up-right-16-solid"
          size={16}
          class="transition-transform group-hover:translate-x-1"
        />
      </LinkButton>
    </div>
    <Frame data-stagger-index="3">
      <div class="flex flex-col gap-4 md:p-6 lg:p-8">
        <h3 class="text-muted-foreground text-xs tracking-wider uppercase">
          Technologies
        </h3>
        <ul class="grid grid-cols-2 gap-2">
          {
            technologies.map(({ data }, index) => (
              <li data-stagger-index={index + 3}>
                <Technology
                  label={data.label}
                  category={data.category}
                  icon={data.icon}
                />
              </li>
            ))
          }
        </ul>
      </div>
    </Frame>
  </section>
  <section
    id="projects"
    class="scroll-mt-header mx-auto flex max-w-7xl flex-col gap-16 px-4 py-16 md:gap-24 md:px-6 md:py-24 lg:px-8"
    data-animate
  >
    <div class="flex flex-col items-start gap-4">
      <h2 class="text-3xl font-semibold" data-stagger-index="0">
        A glimpse into my work.
      </h2>
      <p class="text-muted-foreground text-lg" data-stagger-index="1">
        Here are some projects I've loved working on.
      </p>
      <LinkButton
        href="/projects"
        class="group mt-2 gap-2"
        data-stagger-index="2"
      >
        See all projects
        <Icon
          name="heroicons:arrow-right-16-solid"
          size={16}
          class="transition-transform group-hover:translate-x-1"
        />
      </LinkButton>
    </div>
    <ul class="grid grid-cols-1 gap-4 md:grid-cols-2">
      {
        featuredProjects.map((project, index) => (
          <li class="md:even:-translate-y-34" data-stagger-index={index + 3}>
            <ProjectCard
              href={`/projects/${project.id}`}
              title={project.data.title}
              description={project.data.description}
              image={project.data.image}
              color={project.data.color}
            />
          </li>
        ))
      }
    </ul>
  </section>
  <section
    id="contact"
    class="scroll-mt-header mx-auto grid max-w-7xl gap-16 px-4 py-16 md:grid-cols-2 md:gap-4 md:px-6 md:pt-24 md:pb-48 lg:px-8"
    data-animate
  >
    <div class="flex flex-col gap-4 md:items-start md:pt-12 lg:pr-12">
      <h2 class="text-3xl font-semibold" data-stagger-index="0">
        Get in touch.
      </h2>
      <p class="text-muted-foreground text-lg" data-stagger-index="1">
        I'm always open to new opportunities and collaborations. Whether you
        have a project in mind or just want to say hello, feel free to reach
        out!
      </p>
      <span class="bg-border h-px w-full" data-stagger-index="2"></span>
      <ul class="flex flex-col gap-3">
        {
          contact.map(({ data }, index) => (
            <li class="w-fit" data-stagger-index={index + 2}>
              <a
                href={data.url}
                target="_blank"
                class="group focus-visible:border-ring focus-visible:ring-ring/50 flex items-center gap-2 text-base font-medium outline-none focus-visible:ring-[3px]"
              >
                <div class="group-hover:bg-accent/50 bg-card grid size-8 place-items-center rounded-lg transition-colors">
                  <Icon name={data.icon} size={16} />
                </div>
                <span class="bg-border h-4 w-px" />
                <span class="text-muted-foreground group-hover:text-foreground transition-colors">
                  {data.text}
                </span>
              </a>
            </li>
          ))
        }
      </ul>
    </div>
    <Frame data-stagger-index={contact.length + 2}>
      <ContactForm class="grid gap-6 md:p-6 lg:p-8">
        <FormField data-stagger-index={contact.length + 2}>
          <FormLabel for="name">Name</FormLabel>
          <FormInput
            type="text"
            name="name"
            id="name"
            placeholder="John Doe"
            required
          />
        </FormField>
        <FormField data-stagger-index={contact.length + 3}>
          <FormLabel for="email">Email</FormLabel>
          <FormInput
            type="email"
            name="email"
            id="email"
            placeholder="example@gmail.com"
            required
          />
        </FormField>
        <FormField data-stagger-index={contact.length + 4}>
          <FormLabel for="message">Message</FormLabel>
          <FormTextarea
            rows={4}
            name="message"
            id="message"
            placeholder="Your message."
            required
          />
        </FormField>
        <Button
          type="submit"
          class="lg:w-fit"
          data-stagger-index={contact.length + 5}
        >
          <Icon name="heroicons:paper-airplane-16-solid" />
          Send message
        </Button>
      </ContactForm>
    </Frame>
  </section>
</MainLayout>

<script>
  document.addEventListener('astro:page-load', () => {
    const contactLink = document.getElementById('contact-link');
    contactLink?.addEventListener('click', (e) => {
      e.preventDefault();
      const section = document.getElementById('contact');
      if (!section) return;
      section.scrollIntoView({ behavior: 'smooth' });
    });
  });
</script>
